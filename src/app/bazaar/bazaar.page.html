<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>
      <div class="flex-space-between">
        <div class="flex-center">
          Bazaar L{{buildingService.getBuilding(buildingType).level}}
        </div>
        <div class="flex-center">
          <ion-button size="small" fill="clear" color="dark" (click)="close()">
            <ion-icon name="close"></ion-icon>
          </ion-button>
        </div>
      </div>
    </ion-title>
  </ion-toolbar>
</ion-header>

<div *ngIf="saving" class="loading-indicator"><img src="assets/icon/logo.png" alt="" class="logo"></div>
<looted></looted>
<ion-content>
  <ion-segment [(ngModel)]="tab">
    <ion-segment-button value="merchant">
      <ion-label>Merchant</ion-label>
    </ion-segment-button>
    <ion-segment-button value="shop">
      <ion-label>Shop</ion-label>
    </ion-segment-button>
    <ion-segment-button value="trader">
      <ion-label>Trader</ion-label>
    </ion-segment-button>
  </ion-segment>

  <div *ngIf="tab == 'merchant'">
    Merchant is not implemented yet. You'll find here offers from merchant which you can accept by paying coins or rubies
  </div>

  <div *ngIf="tab == 'shop'">
    Shop is not implemented yet. You'll here find offers from ambrosia inc to purchase with real money
  </div>

  <ion-card *ngIf="tab == 'trader'">
    <ion-card-header>
      <div class="flex-space-between">
        <div class="flex-start">{{model.resources.metal}} <img src="assets/icon/resources/METAL.png" class="resource-icon ml-05"></div>
        <div class="flex-start">{{model.resources.iron}} <img src="assets/icon/resources/IRON.png" class="resource-icon ml-05"></div>
        <div class="flex-start">{{model.resources.steel}} <img src="assets/icon/resources/STEEL.png" class="resource-icon ml-05"></div>
        <div class="flex-start">{{model.resources.wood}} <img src="assets/icon/resources/WOOD.png" class="resource-icon ml-05"></div>
        <div class="flex-start">{{model.resources.brownCoal}} <img src="assets/icon/resources/BROWN_COAL.png" class="resource-icon ml-05"></div>
        <div class="flex-start">{{model.resources.blackCoal}} <img src="assets/icon/resources/BLACK_COAL.png" class="resource-icon ml-05"></div>
      </div>
      The trader offers you goods for goods. The ratio is of course in the traders favor. Increase your negotiation level to get a better ratio.
    </ion-card-header>
    <ion-card-content>
      <ion-item *ngFor="let trade of enumService.getTrades()">
        Exchange <strong class="ml-1">{{trade.giveAmount - (model.progress.negotiationLevel * trade.negotiationGiveReduction)}}</strong> <img src="assets/icon/resources/{{trade.giveType}}.png" class="resource-icon ml-05 mr-1"> to get <strong class="ml-1">{{trade.getAmount + (model.progress.negotiationLevel * trade.negotiationGetIncrease)}}</strong> <img src="assets/icon/resources/{{trade.getType}}.png" class="resource-icon ml-05 mr-05">
        <ion-button size="small" fill="outline" (click)="acceptTrade(trade.name)" [disabled]="!model.hasEnoughResources(trade.giveType, trade.giveAmount - (model.progress.negotiationLevel * trade.negotiationGiveReduction))">Deal</ion-button>
      </ion-item>
    </ion-card-content>
  </ion-card>
</ion-content>
